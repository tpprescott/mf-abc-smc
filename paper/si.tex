\documentclass[demo,supplement,review]{siamonline190516}

\input{shared}
\externaldocument{article}

\begin{document}
\maketitle

\section{Choice of summary statistics}
\label{appendix:summary_statistics}

Recall the summary statistics
\begin{align*}
S_1(R, \Phi) &= \left( \frac{1}{30} \int_0^{30} R(t) ~\mathrm dt \right)^2, \\
S_2(R, \Phi) &= \frac{1}{30} \left( \Phi(30) - \Phi(0) \right), \\
S_3(R, \Phi) &= R \left( T_{1/2} \right),
\end{align*}
where $T_{1/2}$ is the first value of $t \in [0,30]$ for which $\obs R(t)$ is halfway between $\obs R(0)=1$ and its average value $S_1(\obs R, \obs \Phi)^{1/2}$.
These statistics are connected to trajectories,$\phi_j(t)$ for $j =1,\dots,256$, of the high-fidelity model, \Cref{eq:Kuramoto_hi}, through the definition
\[
R(t) \exp (i \Phi(t)) = \frac{1}{256} \sum_{j=1}^{256} \exp(i \phi_j(t)).
\]
The low-fidelity model, in \Cref{eq:Kuramoto_lo}, directly models the evolution of $R$ and $\Phi$.
Example trajectories of the low-fidelity and high-fidelity model are shown in \Cref{fig:eg_dynamics}.

We can use the model in \Cref{eq:Kuramoto_lo} to justify the choice of summary statistics.
In particular, the steady-state value of $\tilde R$ is equal to
\[
\tilde R^\star = \left( 1 - 2\frac{\gamma}{K} \right)^{1/2},
\]
while we can write the solution $\tilde \Phi(t) = \omega_0 t$.
Then we use $S_1$ to approximate $(\tilde R^\star)^2 = 1 - 2\gamma/K$ and thus identify the ratio $\gamma/K$.
Similarly, $S_2 = \tilde \Phi(30)/30 = \omega_0$ allows us to directly identify $\omega_0$.
Finally, $S_3$ is a measure of the time-scale of the dynamics.
Trajectories with equal values for $S_1$ (i.e. equal steady states, and thus equal values for $\gamma/K$) can be distinguished by the speed at which they reach their steady state, which we will infer through $S_3$.
Note that the sampling point, $T_{1/2}$, used in $S_3$ is chosen to be relevant to the observed data specifically, and aims to distinguish any simulated trajectories from $\obs R$ and $\obs \Omega$ in particular.
Thus we select $S_3$ to identify the scale of $\gamma$ and $K$.
Hence, we assume that these three summary statistics will be sufficient to identify the parameters.


\section{Posterior samples}
\Cref{post:ABC:Rejection,post:ABC:SMC,post:ABC:SMC:ESS400,post:ABC:SMC:adaptive,post:MFABC:Rejection,post:MFABC:SMC:ESS400,post:MFABC:SMC:adaptive}
show samples from the posterior distributions $p_\epsilon((K, \omega_0, \gamma)~|~\obs y)$ approximating the Bayesian posteriors of the parameters for the Kuramoto oscillator network in \Cref{s:Example}.
The samples have been generated using \Cref{ABC:Rejection} (ABC-RS), \Cref{ABC:SMC} (ABC-SMC), \Cref{MFABC:Rejection} (MF-ABC-RS), and \Cref{MFABC:SMC} (MF-ABC-SMC).

The plots on the diagonal are one-dimensional empirical marginals for each parameter (i.e. weighted histograms).
The plots above the diagonal are all of the two-dimensional empirical marginals for each parameter pair, represented as heat maps.
The axes are discretised for this visualisation by partitioning each parameter's prior support into $B$ bins, where $B$ is the integer nearest to $(2 \times \mathrm{ESS})^{1/2}$.
For example, when $\mathrm{ESS} \approx 400$, each axis is partitioned into $28 \approx \sqrt{800}$ bins across its prior support.
The plots below the diagonal are all of the two-dimensional projections of the Monte Carlo set $\{ \theta_n, w_n \}$, where the weights $w_n$ are represented by colour.
In particular, negative weights are coloured orange and positive weights are purple.
Note that, for simplicity of visualisation, the weights are rescaled (without any loss of generality) to take values between $-1$ and $+1$.

\subsection{Existing ABC algorithms}
The posterior samples in \Cref{post:ABC:Rejection,post:ABC:SMC,post:MFABC:Rejection} from $p_{0.5}((K, \omega_0, \gamma)~|~\obs y)$ are generated by running \Cref{ABC:Rejection,ABC:SMC,MFABC:Rejection} for a fixed total of $N=6000$ parameter proposals and with threshold $\epsilon = 0.5$. 
For \Cref{ABC:SMC}, these proposals are split equally across four generations with decreasing thresholds $\epsilon_t = 2, 1.5, 1, 0.5$. 
The efficiency of generating these posterior samples is discussed in \Cref{s:existing}.

\subsection{Sequential Monte Carlo}
The posterior samples in \Cref{post:ABC:SMC:ESS400,post:MFABC:SMC:ESS400} from $p_{0.1}((K, \omega_0, \gamma)~|~\obs y)$ are generated by running the two SMC algorithms, \Cref{ABC:SMC,MFABC:SMC}, for eight generations with a common schedule of thresholds $\epsilon_t = 2, 1.5, 1, 0.8, 0.6, 0.4, 0.2, 0.1$, and with stopping condition of $\mathrm{ESS}=400$ at each generation.
Each figure is one representative output of the 50 runs of each of \Cref{ABC:SMC,MFABC:SMC} used in \Cref{s:Results}, where the efficiency of generating these posterior samples is discussed.

\subsection{Adaptive epsilon}
The posterior samples in \Cref{post:ABC:SMC:adaptive,post:MFABC:SMC:adaptive} are generated by the extension of the two SMC algorithms, \Cref{ABC:SMC,MFABC:SMC}, to allow for adaptive selection of thresholds $\epsilon$ as discussed in \Cref{s:Adaptive}.
Running the adaptive extensions of each of \Cref{ABC:SMC,MFABC:SMC} for four generations, with a fixed efficiency in each generation and stopping condition $\mathrm{ESS}=400$, produces the posterior samples in \Cref{post:ABC:SMC:adaptive,post:MFABC:SMC:adaptive}, respectively, from $p_{0.55}((K, \omega_0, \gamma)~|~\obs y)$ and $p_{0.09}((K, \omega_0, \gamma)~|~\obs y)$, respectively.

\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_abc_rs}
\caption{
Sample from ABC posterior generated by \Cref{ABC:Rejection}.
}
\label{post:ABC:Rejection}
\end{figure*}

\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_abc_smc}
\caption{
Sample from ABC posterior produced using the final generation of \Cref{ABC:SMC}.
}
\label{post:ABC:SMC}
\end{figure*}

\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_mfabc_rs}
\caption{
Sample from ABC posterior generated by \Cref{MFABC:Rejection}.
}
\label{post:MFABC:Rejection}
\end{figure*}

\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_abc_smc_ESS400}
\caption{
Sample from ABC posterior produced using the final generation of \Cref{ABC:SMC}.
}
\label{post:ABC:SMC:ESS400}
\end{figure*}

\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_mfabc_smc_ESS400}
\caption{
Sample from ABC posterior produced using the final generation of \Cref{MFABC:SMC}.
}
\label{post:MFABC:SMC:ESS400}
\end{figure*}


\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_abc_smc_adaptive}
\caption{
Sample from ABC posterior produced by the final generation of the adaptive modification of \Cref{ABC:SMC}, as described in \Cref{s:Adaptive}.
}
\label{post:ABC:SMC:adaptive}
\end{figure*}

\begin{figure*}[p]
\centering
\includegraphics[width=\textwidth]{posterior_mfabc_smc_adaptive}
\caption{
Sample from ABC posterior produced by the final generation of the adaptive modification of \Cref{MFABC:SMC}, as described in \Cref{s:Adaptive}.
}
\label{post:MFABC:SMC:adaptive}
\end{figure*}

\end{document}
